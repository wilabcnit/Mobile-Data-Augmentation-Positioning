import numpy as np
from scipy import stats

def mean_pm(data, confidence=0.95):
    data = np.asarray(data, dtype=float)
    n = len(data)
    mean = data.mean()
    s = data.std(ddof=1)
    se = s / np.sqrt(n)
    tcrit = stats.t.ppf((1 + confidence) / 2, df=n - 1)
    moe = tcrit * se
    return mean, moe
#MAE on original data 
runs = {
"NN_airport": [0.60, 0.62, 0.59, 0.60, 0.60, 0.59, 0.62, 0.60, 0.60, 0.60],
"NN_stadium": [1.16, 1.19, 1.21, 1.14, 1.21, 1.15, 1.14, 1.14, 1.17, 1.20],
"NN_highway": [2.41, 2.34, 2.34, 2.48, 2.34, 2.31, 2.41, 2.36, 2.41],
"NN_citycenter": [0.81, 0.81, 0.79, 0.81, 0.80, 0.79, 0.81, 0.78, 0.81, 0.78],
"GAN_plain_MAE_stadium": [1.16, 1.15, 1.21, 1.14, 1.21, 1.16, 1.15, 1.15, 1.14, 1.21],
"GAN_plain_MAE_Highway": [2.34, 2.33, 2.25, 2.37, 2.27, 2.27, 2.39, 2.30, 2.34, 2.31],
"GAN_plain_MAE_citycenter": [0.82, 0.81, 0.79, 0.80, 0.79, 0.80, 0.82, 0.79, 0.82, 0.78],
"GAN_plain_MAE_Airport": [0.60,0.61,0.60,0.61,0.60,0.58,0.59,0.59,0.59,0.59],
"RectifiedFlow_MAE_Airport": [0.93, 0.94, 0.92, 0.92, 0.91, 0.93,0.93,0.94,0.97,0.96],
"RectifiedFlow_MAE_Highway": [2.65, 2.61, 2.55, 2.67, 2.60, 2.57, 2.68, 2.59, 2.66, 2.61],
"RectifiedFlow_MAE_CityCenter": [1.13, 1.12, 1.11, 1.11, 1.10, 1.11, 1.15,1.13,1.26,1.12],
"RectifiedFlow_MAE_Stadium": [1.46, 1.44, 1.51, 1.44, 1.52, 1.45, 1.46, 1.44, 1.44, 1.50],
"NF_MAE_209_Aiport": [0.93, 1.03, 1.33, 0.83, 1.54, 1.20, 1.36, 1.32, 1.24, 1.38],
"NF_MAE_52_Highway": [3.54, 3.45, 4.62, 3.21, 6.63, 3.44, 4.42, 4.10, 3.89, 4.67],


 }

for name, data in runs.items():
    m, x = mean_pm(data, confidence=0.95)
    print(f"{name}: {m:.2f}$\pm${x:.3f}")


#For Comaprison 
# import numpy as np
# from scipy import stats
# import pandas as pd

# # Function to perform statistical comparison with confidence interval
# def compare_models_ci(data1, data2, label1, label2, confidence=0.95):
#     n1, n2 = len(data1), len(data2)
#     mean1, mean2 = np.mean(data1), np.mean(data2)
#     var1, var2 = np.var(data1, ddof=1), np.var(data2, ddof=1)

#     # Standard error of difference
#     se_diff = np.sqrt(var1/n1 + var2/n2)

#     # Confidence interval calculation
#     alpha = 1 - confidence
#     z = stats.norm.ppf(1 - alpha / 2)  # Two-tailed test
#     diff = mean1 - mean2
#     ci_min, ci_max = diff - z * se_diff, diff + z * se_diff

#     # Determine statistical significance
#     result = "NO significant difference" if ci_min <= 0 <= ci_max else f"{label1} is better" if mean1 < mean2 else f"{label2} is better"
    
#     return {
#         "Comparison": f"{label1} vs {label2}",
#         "Mean Difference": round(diff, 3),
#         "95% CI": (round(ci_min, 3), round(ci_max, 3)),
#         "Result": result
#     }

# # Data for different augmentations (10 runs each)
# x10_runs = np.array([21.7394, 17.5771, 20.7353, 16.6904, 19.2809, 21.4971, 19.0775, 20.9338, 19.0142, 19.4255])
# x20_runs = np.array([17.7706, 18.1253, 18.1253, 15.6522, 17.0206, 17.9464, 18.0975, 16.9987, 16.9308, 17.2811])
# x30_runs = np.array([16.6095, 18.2373, 15.8776, 16.3339, 16.5006, 17.0084, 18.0360, 15.9764, 16.5327, 16.8994])
# x40_runs = np.array([17.0045, 17.4669, 16.5371, 16.8068, 16.9037, 17.4703, 17.7315, 17.1156, 17.1482, 17.3073])

# # Perform pairwise statistical comparisons
# results_95 = [
#     compare_models_ci(x10_runs, x20_runs, "X10", "X20", confidence=0.95),
#     compare_models_ci(x10_runs, x30_runs, "X10", "X30", confidence=0.95),
#     compare_models_ci(x10_runs, x40_runs, "X10", "X40", confidence=0.95),
#     compare_models_ci(x20_runs, x30_runs, "X20", "X30", confidence=0.95),
#     compare_models_ci(x20_runs, x40_runs, "X20", "X40", confidence=0.95),
#     compare_models_ci(x30_runs, x40_runs, "X30", "X40", confidence=0.95)
# ]

# # Convert results to DataFrame and display
# df_results_95 = pd.DataFrame(results_95)
# print(df_results_95)





#STADIUM

#MLP
# runs = {
#     "X5": [39.522, 39.236, 39.59, 39.984, 39.193, 39.193, 40.009, 39.644, 39.087, 39.543],
#     "X10": [38.931, 38.93, 39.213, 38.351, 38.426, 38.891, 38.711, 39.242, 38.753, 38.551],
#     "X20": [36.391, 35.799, 35.901, 35.379, 35.687, 35.916, 35.475, 36.009, 35.667, 35.776],
#     "X30": [37.013, 37.749, 37.189, 36.876, 37.44, 36.827, 37.256, 36.605, 36.795, 37.252]
# }
# #rectiedflow
# runs = {
#     "X5": [41.795, 41.455, 41.282, 41.171, 40.465, 40.92, 41.075, 41.986, 41.558, 40.294],
#     "X10": [40.569, 40.179, 40.018, 40.727, 40.957, 40.903, 39.929, 40.22, 40.573, 40.927],
#     "X20": [38.268, 38.415, 37.954, 37.909, 38.914, 39.186, 38.472, 39.009, 38.688, 38.185],
#     "X30": [39.084, 39.614, 38.905, 39.626, 37.743, 39.291, 38.961, 38.787, 38.963, 38.027]
# }
# #GAN
# runs = {
#     "X5": [48.147, 48.781, 50.014, 47.818, 47.499, 47.836, 49.395, 48.75, 47.806, 48.953],
#     "X10": [47.059, 47.974, 46.219, 46.613, 46.545, 45.42, 47.268, 47.231, 46.962, 46.71],
#     "X20": [43.902, 44.847, 44.921, 44.485, 45.094, 45.631, 47.039, 45.413, 45.492, 45.176],
#     "X30": [44.149, 45.852, 45.93, 48.093, 45.703, 46.147, 45.845, 44.824, 46.904, 46.553]
# }
# #NF
# runs = {
#     "X5": [54.2063, 55.5015, 54.7014, 55.5332, 54.6688, 55.9905, 55.0966, 55.8224, 53.3415, 55.1378],
#     "X10": [54.4056, 55.8594, 54.3897, 55.0603, 54.3817, 55.5217, 56.1545, 54.7496, 55.0483, 54.4291],
#     "X20": [53.4191, 52.9224, 53.9512, 53.2095, 52.296, 50.2054, 53.8455, 53.3058, 54.0766, 52.7683],
#     "X30": [54.2095, 53.615, 53.4406, 54.552, 54.2732, 53.4016, 53.8864, 54.7238, 53.8345, 54.0635]
# }
# #CITYCENTER
# #MLP
# runs = {

#     "X5": [25.6448, 25.6077, 25.5879, 26.0485, 25.939, 25.5754, 26.422, 25.7092, 25.6752, 25.7903],
#     "X10": [24.1005, 23.9975, 23.9657, 24.1858, 24.4508, 24.1333, 23.7397, 24.301, 24.0137, 24.1119],
#     "X20": [23.2764, 22.4875, 22.848, 22.9015, 22.4418, 22.5847, 22.7989, 22.7799, 23.1306, 22.7507],
#     "X30": [22.2148, 21.9393, 21.7422, 22.1779, 21.8697, 21.9928, 22.0136, 22.0683, 22.2344, 21.747]
# }

# #RectifiedLFow
# runs = {
#     "X5": [24.0574, 24.5805, 24.7831, 24.4317, 24.7402, 24.6234, 24.5502, 24.2273, 24.4475, 24.5586],
#     "X10": [24.2702, 23.8545, 23.9104, 23.8296, 23.8591, 23.665, 23.5592, 23.85, 23.3252, 23.8769],
#     "X20": [21.1398, 21.0062, 21.03, 20.6739, 21.0735, 20.8991, 20.7478, 20.677, 20.8161, 20.4367],
#     "X30": [21.2476, 21.4651, 21.6068, 21.4376, 21.2837, 22.0344, 21.6172, 21.6175, 21.3068, 21.3834]
# }
# #NF
# runs = {
#     "X5": [37.5179, 42.0794, 39.0897, 40.6661, 39.2797, 39.6372, 41.8938, 39.58, 38.4245, 41.8318],
#     "X10": [38.37, 39.5081, 38.6306, 38.5037, 38.5214, 39.3505, 39.5872, 39.7869, 38.7212, 39.0205],
#     "X20": [37.2117, 37.6468, 37.8742, 36.9154, 37.3866, 36.929, 37.5635, 38.3453, 37.3078, 37.8196],
#     "X30": [37.9265, 38.3513, 38.0334, 37.386, 37.8255, 38.021, 37.8263, 37.2551, 37.8655, 37.5095]
# }
# #CGAN
# runs = {
#     "X5": [29.7135, 30.7124, 31.4393, 31.452, 30.0608, 30.63, 30.1475, 28.9791, 30.6087, 31.2567],
#     "X10": [28.049, 30.0202, 27.4841, 28.6502, 28.7415, 28.9195, 28.3842, 28.1342, 28.0565, 27.5607],
#     "X20": [26.6211, 25.89, 27.3196, 25.4015, 27.1659, 27.1536, 26.4921, 26.688, 25.8431, 26.4252],
#     "X30": [27.2295, 28.2922, 29.0708, 27.7744, 27.4719, 27.7016, 27.9818, 27.7752, 27.5083, 27.1944]
# }
# #Airport
# #MLP
# runs = {

#     "X5": [85.727, 89.4251, 88.1061, 87.0505, 87.7207, 87.2868, 87.0796, 87.848, 86.5619, 88.1943],
#     "X10": [88.5844, 87.7337, 89.5306, 88.7104, 87.4877, 88.7036, 87.5308, 87.7761, 87.4823, 87.4605],
#     "X20": [85.0773, 84.9593, 84.8993, 86.0029, 85.2223, 86.417, 85.7989, 85.9865, 84.9784, 85.6581],
#     "X30": [87.5105, 88.1779, 89.7433, 87.0698, 88.5472, 87.9912, 88.5366, 87.1663, 88.9164, 88.3408]
# }
# #NF
# runs = {
#     "X5": [111.9938, 110.4364, 110.4553, 110.8503, 108.6217, 109.7125, 110.4457, 110.1918, 109.5879, 111.1044],
#     "X10": [111.824, 111.2583, 110.8057, 110.6073, 111.375, 110.0135, 110.2589, 112.8325, 111.8479, 111.8769],
#     "X20": [109.6972, 110.1424, 110.2566, 109.3957, 109.4437, 110.4977, 109.7053, 108.7057, 108.3037, 109.252],
#     "X30": [110.4851, 110.939, 109.6616, 109.6851, 110.3524, 110.8909, 109.7983, 111.2726, 110.3901, 110.425]
# }
# #RectifiedLFow
# runs = {

#     "X5": [94.2819, 95.3562, 94.8366, 94.9853, 96.4404, 92.4908, 94.4292, 92.275, 93.418, 93.4866],
#     "X10": [93.6721, 94.2576, 93.4334, 94.4727, 94.593, 91.8804, 93.1131, 94.5141, 95.665, 92.3986],
#     "X20": [91.125, 88.5544, 91.9199, 91.1316, 92.1384, 92.8526, 92.4044, 90.622, 89.8382, 91.4136],
#     "X30": [90.2122, 92.9091, 90.4785, 91.9458, 93.5772, 95.3318, 92.339, 92.8955, 92.3679, 92.9429]
# }

# #CGAN
# runs = {

#     "X5": [98.8291, 98.4623, 98.6384, 98.7662, 98.1047, 98.1913, 99.3421, 96.568, 97.7879, 100.3102],
#     "X10": [103.2207, 105.2473, 104.5281, 105.5241, 105.785, 102.486, 103.1121, 103.4873, 103.2802, 105.3293],
#     "X20": [102.5047, 102.0741, 102.9558, 105.0346, 104.9698, 102.0843, 104.3584, 103.1553, 101.8341, 102.0288],
#     "X30": [101.9187, 102.3521, 100.8444, 103.415, 100.301, 102.2346, 101.9586, 100.0575, 101.6751, 99.243]
# }

# #Highway
# #MLP
# runs = {   
#     "X5": [124.0823, 125.9197, 124.1732, 124.9729, 127.4518, 125.2619, 125.7151, 128.1757, 126.4218, 125.8256],
#     "X10": [119.127, 115.3429, 118.2373, 120.5554, 117.1949, 120.2, 118.9132, 119.107, 119.7866, 116.5357],
#     "X20": [115.8443, 115.0209, 116.0414, 113.3592, 117.5896, 112.1465, 113.0183, 114.601, 113.8185, 113.5601],
#     "X30": [112.7858, 114.9494, 115.4056, 114.0587, 112.5106, 116.2019, 113.1945, 112.4489, 114.6077, 111.8368]
# }
# #NF
# runs = {
#     "X5": [167.362, 167.1807, 167.3154, 170.8857, 170.9847, 167.5694, 167.2716, 168.2041, 166.5217, 167.0046],
#     "X10": [170.1615, 168.6886, 170.4144, 172.2377, 170.6999, 173.3671, 173.4681, 170.412, 170.2945, 170.3562],
#     "X20": [171.0225, 168.9197, 172.0595, 174.1026, 171.026, 171.1701, 170.8575, 170.878, 170.9849, 170.679],
#     "X30": [171.7224, 168.6333, 172.9782, 176.1056, 171.4062, 171.9511, 171.8304, 171.872, 172.0333, 171.6674]
# }

# #RectifiedLFow
# runs = {
#     "X5": [132.7063, 129.9911, 130.2988, 131.7006, 128.6707, 127.3908, 132.1506, 130.962, 130.2554, 130.8737],
#     "X10": [125.9619, 125.3079, 121.1864, 126.7352, 129.7956, 124.8718, 125.5629, 126.2372, 124.9442, 127.3967],
#     "X20": [118.962, 115.8907, 119.5186, 119.609, 119.1846, 119.2236, 118.902, 119.7112, 119.9867, 123.0115],
#     "X30": [120.4298, 118.9893, 123.0443, 121.2688, 117.542, 120.9772, 122.026, 122.6769, 120.5001, 123.5456]
# }

#CGAN
# runs = {
#     "X5": [146.6374, 147.3982, 145.2661, 144.4183, 141.7803, 145.807, 145.2455, 149.9541, 145.0015, 140.4917],
#     "X10": [141.7394, 141.6449, 140.3759, 143.4143, 142.6866, 137.8627, 138.8241, 139.2895, 142.2705, 142.892],
#     "X20": [136.7801, 137.7325, 135.854, 136.3309, 134.9331, 130.9884, 134.0643, 135.7362, 134.5713, 135.8091],
#     "X30": [132.3605, 133.3979, 136.0532, 139.7762, 137.3849, 134.249, 135.3941, 133.2635, 135.5523, 137.5684]
# }
